package secret

import (
	"testing"

	"github.com/stretchr/testify/assert"
)

const PublicKey = `-----BEGIN PGP PUBLIC KEY BLOCK-----

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
=OwLN
-----END PGP PUBLIC KEY BLOCK-----`
const PrivateKey = `-----BEGIN PGP PRIVATE KEY BLOCK-----

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
IBxhETB2sV/gUA0qUttV0d/w
=bz0S
-----END PGP PRIVATE KEY BLOCK-----`
const PrivateKeyPassword = "changeme"

func TestGPGEncrypt(t *testing.T) {
	enc, encErr := EncryptOpenPGP(PublicKey, "my secret")
	assert.NoError(t, encErr)

	dec, decErr := DecryptOpenPGP(PrivateKey, PrivateKeyPassword, enc)
	assert.NoError(t, decErr)
	assert.Equal(t, "my secret", dec)
}
