package appgitlab

import (
	"github.com/cidverse/cid/pkg/common/dependency"
	"github.com/cidverse/cid/pkg/constants"
	"github.com/cidverse/cid/pkg/core/catalog"
)

var mergeRequestFooter = "This PR has been generated by the [CID GitLab App](https://gitlab.com/cidverse-app)."

var gitlabNetworkAllowList = []catalog.ActionAccessNetwork{
	// GitHub Platform
	{Host: "github.com:443"},
	{Host: "api.github.com:443"},
	{Host: "codeload.github.com:443"},
	{Host: "uploads.github.com:443"},
	{Host: "objects.githubusercontent.com:443"},
	{Host: "raw.githubusercontent.com:443"},
	// GitHub Container Registry
	{Host: "ghcr.io:443"},
	{Host: "pkg-containers.githubusercontent.com:443"},
}

var gitlabWorkflowDependencyList = []dependency.Dependency{
	// tools
	{
		Id:      "cidverse/cid",
		Type:    "github",
		Version: constants.Version,
	},
	// oci-containers
	{
		Id:         "podman/stable",
		Type:       "docker",
		Version:    "v5.7.0-immutable",
		Hash:       "e373092f93d45249cb4409d4bff2d71f26d808a1dae18ed78d3f7c18f82c5fea",
		Repository: "quay.io",
	},
	{
		Id:         "docker",
		Type:       "docker",
		Version:    "28.3.3-dind",
		Hash:       "acf2e2d09cedf21fa8f27bb0962674e33e159c744c152b248f1f7f43623ccd82",
		Repository: "docker.io",
	},
	{
		Id:      "cidverse/container-images/ci-gitlab",
		Type:    "docker",
		Version: "0.1.0",
		//Hash:    "",
		Repository: "registry.gitlab.com",
	},
	{
		Id:      "cidverse/container-images/ci-gitlab-docker",
		Type:    "docker",
		Version: "0.1.0",
		//Hash:    "",
		Repository: "registry.gitlab.com",
	},
}

var gitlabWorkflowDependencies = func() map[string]dependency.Dependency {
	m := make(map[string]dependency.Dependency, len(gitlabWorkflowDependencyList))
	for _, dep := range gitlabWorkflowDependencyList {
		//slog.Debug("GitLab Dependency ID: " + dep.AsPackageUrlNoVersion())
		m[dep.AsPackageUrlNoVersion()] = dep
	}
	return m
}()
